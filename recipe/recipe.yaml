schema_version: 1

context:
  name: bazel-toolchain
  version: 0.3.1

package:
  name: ${{ name|lower }}
  version: ${{ version }}

build:
  number: 1
  skip: win

requirements:
  run_constraints:
    - bazel >=6
    - sed

tests:
  - requirements:
      run:
        - ${{ stdlib('c') }}
        - ${{ compiler('c') }}
        - ${{ compiler('cxx') }}
        - bazel

about:
  summary: Helper script to generate a crosscompile toolchain for Bazel with the currently activated compiler settings.
  description: |
    This package generates a crosstool toolchain for Bazel that uses the currently
    activated compilers / linker as defined by the environment variables. It does
    take various conda(-forge) specifics into account for this. In addition to generating
    a toolchain, it also sets various environment variables that need to be set for
    the toolchain to work. Especially you will need to pass in the correct ${TARGET_CPU}
    to ensure that cross-compiling also works.

    In build.sh

    source gen-bazel-toolchain
    bazel build --crosstool_top=//bazel_toolchain:toolchain --cpu ${TARGET_CPU} â€¦

  license: BSD-3-Clause AND Apache-2.0
  license_file: LICENSE.txt
  homepage: https://github.com/conda-forge/bazel-toolchain-feedstock

extra:
  recipe-maintainers:
    - xhochy
    - wolfv

